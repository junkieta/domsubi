var vi=Object.create;var me=Object.defineProperty;var Ai=Object.getOwnPropertyDescriptor;var _i=Object.getOwnPropertyNames;var gi=Object.getPrototypeOf,bi=Object.prototype.hasOwnProperty;var Ci=n=>me(n,"__esModule",{value:!0});var N=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var Si=(n,t,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of _i(t))!bi.call(n,r)&&r!=="default"&&me(n,r,{get:()=>t[r],enumerable:!(e=Ai(t,r))||e.enumerable});return n},vt=n=>Si(Ci(me(n!=null?vi(gi(n)):{},"default",n&&n.__esModule&&"default"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);var U=N(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});var xi=Object.prototype.hasOwnProperty;j.has=function(n,t){return xi.call(n,t)};function Ei(n,t){return n<t?-1:n===t?0:1}j.defaultCompare=Ei;function Bi(n,t){return n===t}j.defaultEquals=Bi;function Li(n){return n===null?"COLLECTION_NULL":kt(n)?"COLLECTION_UNDEFINED":ye(n)?"$s"+n:"$o"+n.toString()}j.defaultToString=Li;function wi(n,t){if(t===void 0&&(t=","),n===null)return"COLLECTION_NULL";if(kt(n))return"COLLECTION_UNDEFINED";if(ye(n))return n.toString();var e="{",r=!0;for(var i in n)j.has(n,i)&&(r?r=!1:e=e+t,e=e+i+":"+n[i]);return e+"}"}j.makeString=wi;function mr(n){return typeof n=="function"}j.isFunction=mr;function kt(n){return typeof n=="undefined"}j.isUndefined=kt;function ye(n){return Object.prototype.toString.call(n)==="[object String]"}j.isString=ye;function Ti(n){return kt(n)||!mr(n)?function(t,e){return t<e?1:t===e?0:-1}:function(t,e){return n(t,e)*-1}}j.reverseCompareFunction=Ti;function Di(n){return function(t,e){return n(t,e)===0}}j.compareToEquals=Di});var lt=N(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var Ft=U();function ve(n,t,e){for(var r=e||Ft.defaultEquals,i=n.length,s=0;s<i;s++)if(r(n[s],t))return s;return-1}Q.indexOf=ve;function Ni(n,t,e){for(var r=e||Ft.defaultEquals,i=n.length,s=i-1;s>=0;s--)if(r(n[s],t))return s;return-1}Q.lastIndexOf=Ni;function Ii(n,t,e){return ve(n,t,e)>=0}Q.contains=Ii;function Vi(n,t,e){var r=ve(n,t,e);return r<0?!1:(n.splice(r,1),!0)}Q.remove=Vi;function ki(n,t,e){for(var r=e||Ft.defaultEquals,i=n.length,s=0,l=0;l<i;l++)r(n[l],t)&&s++;return s}Q.frequency=ki;function Fi(n,t,e){var r=e||Ft.defaultEquals;if(n.length!==t.length)return!1;for(var i=n.length,s=0;s<i;s++)if(!r(n[s],t[s]))return!1;return!0}Q.equals=Fi;function qi(n){return n.concat()}Q.copy=qi;function Oi(n,t,e){if(t<0||t>=n.length||e<0||e>=n.length)return!1;var r=n[t];return n[t]=n[e],n[e]=r,!0}Q.swap=Oi;function $i(n){return"["+n.toString()+"]"}Q.toString=$i;function zi(n,t){for(var e=0,r=n;e<r.length;e++){var i=r[e];if(t(i)===!1)return}}Q.forEach=zi});var rt=N(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});var W=U(),Ri=function(){function n(t){this.table={},this.nElements=0,this.toStr=t||W.defaultToString}return n.prototype.getValue=function(t){var e=this.table["$"+this.toStr(t)];if(!W.isUndefined(e))return e.value},n.prototype.setValue=function(t,e){if(!(W.isUndefined(t)||W.isUndefined(e))){var r,i="$"+this.toStr(t),s=this.table[i];return W.isUndefined(s)?(this.nElements++,r=void 0):r=s.value,this.table[i]={key:t,value:e},r}},n.prototype.remove=function(t){var e="$"+this.toStr(t),r=this.table[e];if(!W.isUndefined(r))return delete this.table[e],this.nElements--,r.value},n.prototype.keys=function(){var t=[];for(var e in this.table)if(W.has(this.table,e)){var r=this.table[e];t.push(r.key)}return t},n.prototype.values=function(){var t=[];for(var e in this.table)if(W.has(this.table,e)){var r=this.table[e];t.push(r.value)}return t},n.prototype.forEach=function(t){for(var e in this.table)if(W.has(this.table,e)){var r=this.table[e],i=t(r.key,r.value);if(i===!1)return}},n.prototype.containsKey=function(t){return!W.isUndefined(this.getValue(t))},n.prototype.clear=function(){this.table={},this.nElements=0},n.prototype.size=function(){return this.nElements},n.prototype.isEmpty=function(){return this.nElements<=0},n.prototype.toString=function(){var t="{";return this.forEach(function(e,r){t+=`
	`+e+" : "+r}),t+`
}`},n}();Ae.default=Ri});var ge=N(_e=>{"use strict";Object.defineProperty(_e,"__esModule",{value:!0});var ji=U(),Ui=lt(),Pi=rt(),Mi=function(){function n(t){this.dictionary=new Pi.default(t)}return n.prototype.contains=function(t){return this.dictionary.containsKey(t)},n.prototype.add=function(t){return this.contains(t)||ji.isUndefined(t)?!1:(this.dictionary.setValue(t,t),!0)},n.prototype.intersection=function(t){var e=this;this.forEach(function(r){return t.contains(r)||e.remove(r),!0})},n.prototype.union=function(t){var e=this;t.forEach(function(r){return e.add(r),!0})},n.prototype.difference=function(t){var e=this;t.forEach(function(r){return e.remove(r),!0})},n.prototype.isSubsetOf=function(t){if(this.size()>t.size())return!1;var e=!0;return this.forEach(function(r){return t.contains(r)?!0:(e=!1,!1)}),e},n.prototype.remove=function(t){return this.contains(t)?(this.dictionary.remove(t),!0):!1},n.prototype.forEach=function(t){this.dictionary.forEach(function(e,r){return t(r)})},n.prototype.toArray=function(){return this.dictionary.values()},n.prototype.isEmpty=function(){return this.dictionary.isEmpty()},n.prototype.size=function(){return this.dictionary.size()},n.prototype.clear=function(){this.dictionary.clear()},n.prototype.toString=function(){return Ui.toString(this.toArray())},n}();_e.default=Mi});var yr=N(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});var be=U(),Qi=rt(),Gi=ge(),Wi=function(){function n(t){this.toStrF=t||be.defaultToString,this.dictionary=new Qi.default(this.toStrF),this.nElements=0}return n.prototype.add=function(t,e){if(e===void 0&&(e=1),be.isUndefined(t)||e<=0)return!1;if(this.contains(t))this.dictionary.getValue(t).copies+=e;else{var r={value:t,copies:e};this.dictionary.setValue(t,r)}return this.nElements+=e,!0},n.prototype.count=function(t){return this.contains(t)?this.dictionary.getValue(t).copies:0},n.prototype.contains=function(t){return this.dictionary.containsKey(t)},n.prototype.remove=function(t,e){if(e===void 0&&(e=1),be.isUndefined(t)||e<=0)return!1;if(this.contains(t)){var r=this.dictionary.getValue(t);return e>r.copies?this.nElements-=r.copies:this.nElements-=e,r.copies-=e,r.copies<=0&&this.dictionary.remove(t),!0}else return!1},n.prototype.toArray=function(){for(var t=[],e=this.dictionary.values(),r=0,i=e;r<i.length;r++)for(var s=i[r],l=s.value,p=s.copies,f=0;f<p;f++)t.push(l);return t},n.prototype.toSet=function(){for(var t=new Gi.default(this.toStrF),e=this.dictionary.values(),r=0,i=e;r<i.length;r++){var s=i[r],l=s.value;t.add(l)}return t},n.prototype.forEach=function(t){this.dictionary.forEach(function(e,r){for(var i=r.value,s=r.copies,l=0;l<s;l++)if(t(i)===!1)return!1;return!0})},n.prototype.size=function(){return this.nElements},n.prototype.isEmpty=function(){return this.nElements===0},n.prototype.clear=function(){this.nElements=0,this.dictionary.clear()},n}();Ce.default=Wi});var qt=N(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});var nt=U(),Hi=lt(),Ki=function(){function n(){this.firstNode=null,this.lastNode=null,this.nElements=0}return n.prototype.add=function(t,e){if(nt.isUndefined(e)&&(e=this.nElements),e<0||e>this.nElements||nt.isUndefined(t))return!1;var r=this.createNode(t);if(this.nElements===0||this.lastNode===null)this.firstNode=r,this.lastNode=r;else if(e===this.nElements)this.lastNode.next=r,this.lastNode=r;else if(e===0)r.next=this.firstNode,this.firstNode=r;else{var i=this.nodeAtIndex(e-1);if(i===null)return!1;r.next=i.next,i.next=r}return this.nElements++,!0},n.prototype.first=function(){if(this.firstNode!==null)return this.firstNode.element},n.prototype.last=function(){if(this.lastNode!==null)return this.lastNode.element},n.prototype.elementAtIndex=function(t){var e=this.nodeAtIndex(t);if(e!==null)return e.element},n.prototype.indexOf=function(t,e){var r=e||nt.defaultEquals;if(nt.isUndefined(t))return-1;for(var i=this.firstNode,s=0;i!==null;){if(r(i.element,t))return s;s++,i=i.next}return-1},n.prototype.contains=function(t,e){return this.indexOf(t,e)>=0},n.prototype.remove=function(t,e){var r=e||nt.defaultEquals;if(this.nElements<1||nt.isUndefined(t))return!1;for(var i=null,s=this.firstNode;s!==null;){if(r(s.element,t))return i===null?(this.firstNode=s.next,s===this.lastNode&&(this.lastNode=null)):s===this.lastNode?(this.lastNode=i,i.next=s.next,s.next=null):(i.next=s.next,s.next=null),this.nElements--,!0;i=s,s=s.next}return!1},n.prototype.clear=function(){this.firstNode=null,this.lastNode=null,this.nElements=0},n.prototype.equals=function(t,e){var r=e||nt.defaultEquals;return!(t instanceof n)||this.size()!==t.size()?!1:this.equalsAux(this.firstNode,t.firstNode,r)},n.prototype.equalsAux=function(t,e,r){for(;t!==null&&e!==null;){if(!r(t.element,e.element))return!1;t=t.next,e=e.next}return!0},n.prototype.removeElementAtIndex=function(t){if(!(t<0||t>=this.nElements||this.firstNode===null||this.lastNode===null)){var e;if(this.nElements===1)e=this.firstNode.element,this.firstNode=null,this.lastNode=null;else{var r=this.nodeAtIndex(t-1);r===null?(e=this.firstNode.element,this.firstNode=this.firstNode.next):r.next===this.lastNode&&(e=this.lastNode.element,this.lastNode=r),r!==null&&r.next!==null&&(e=r.next.element,r.next=r.next.next)}return this.nElements--,e}},n.prototype.forEach=function(t){for(var e=this.firstNode;e!==null&&t(e.element)!==!1;)e=e.next},n.prototype.reverse=function(){for(var t=null,e=this.firstNode,r=null;e!==null;)r=e.next,e.next=t,t=e,e=r;r=this.firstNode,this.firstNode=this.lastNode,this.lastNode=r},n.prototype.toArray=function(){for(var t=[],e=this.firstNode;e!==null;)t.push(e.element),e=e.next;return t},n.prototype.size=function(){return this.nElements},n.prototype.isEmpty=function(){return this.nElements<=0},n.prototype.toString=function(){return Hi.toString(this.toArray())},n.prototype.nodeAtIndex=function(t){if(t<0||t>=this.nElements)return null;if(t===this.nElements-1)return this.lastNode;for(var e=this.firstNode,r=0;r<t&&e!==null;r++)e=e.next;return e},n.prototype.createNode=function(t){return{element:t,next:null}},n}();Se.default=Ki});var Ee=N(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});var Zi=qt(),Ji=function(){function n(){this.list=new Zi.default}return n.prototype.enqueue=function(t){return this.list.add(t)},n.prototype.add=function(t){return this.list.add(t)},n.prototype.dequeue=function(){if(this.list.size()!==0){var t=this.list.first();return this.list.removeElementAtIndex(0),t}},n.prototype.peek=function(){if(this.list.size()!==0)return this.list.first()},n.prototype.size=function(){return this.list.size()},n.prototype.contains=function(t,e){return this.list.contains(t,e)},n.prototype.isEmpty=function(){return this.list.size()<=0},n.prototype.clear=function(){this.list.clear()},n.prototype.forEach=function(t){this.list.forEach(t)},n}();xe.default=Ji});var we=N(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});var Be=U(),Yi=Ee(),Xi=function(){function n(t){this.root=null,this.compare=t||Be.defaultCompare,this.nElements=0}return n.prototype.add=function(t){return Be.isUndefined(t)?!1:this.insertNode(this.createNode(t))!==null?(this.nElements++,!0):!1},n.prototype.clear=function(){this.root=null,this.nElements=0},n.prototype.isEmpty=function(){return this.nElements===0},n.prototype.size=function(){return this.nElements},n.prototype.contains=function(t){return Be.isUndefined(t)?!1:this.searchNode(this.root,t)!==null},n.prototype.search=function(t){var e=this.searchNode(this.root,t);if(e!==null)return e.element},n.prototype.remove=function(t){var e=this.searchNode(this.root,t);return e===null?!1:(this.removeNode(e),this.nElements--,!0)},n.prototype.inorderTraversal=function(t){this.inorderTraversalAux(this.root,t,{stop:!1})},n.prototype.preorderTraversal=function(t){this.preorderTraversalAux(this.root,t,{stop:!1})},n.prototype.postorderTraversal=function(t){this.postorderTraversalAux(this.root,t,{stop:!1})},n.prototype.levelTraversal=function(t){this.levelTraversalAux(this.root,t)},n.prototype.minimum=function(){if(!(this.isEmpty()||this.root===null))return this.minimumAux(this.root).element},n.prototype.maximum=function(){if(!(this.isEmpty()||this.root===null))return this.maximumAux(this.root).element},n.prototype.forEach=function(t){this.inorderTraversal(t)},n.prototype.toArray=function(){var t=[];return this.inorderTraversal(function(e){return t.push(e),!0}),t},n.prototype.height=function(){return this.heightAux(this.root)},n.prototype.searchNode=function(t,e){for(var r=1;t!==null&&r!==0;)r=this.compare(e,t.element),r<0?t=t.leftCh:r>0&&(t=t.rightCh);return t},n.prototype.transplant=function(t,e){t.parent===null?this.root=e:t===t.parent.leftCh?t.parent.leftCh=e:t.parent.rightCh=e,e!==null&&(e.parent=t.parent)},n.prototype.removeNode=function(t){if(t.leftCh===null)this.transplant(t,t.rightCh);else if(t.rightCh===null)this.transplant(t,t.leftCh);else{var e=this.minimumAux(t.rightCh);e.parent!==t&&(this.transplant(e,e.rightCh),e.rightCh=t.rightCh,e.rightCh.parent=e),this.transplant(t,e),e.leftCh=t.leftCh,e.leftCh.parent=e}},n.prototype.inorderTraversalAux=function(t,e,r){t===null||r.stop||(this.inorderTraversalAux(t.leftCh,e,r),!r.stop&&(r.stop=e(t.element)===!1,!r.stop&&this.inorderTraversalAux(t.rightCh,e,r)))},n.prototype.levelTraversalAux=function(t,e){var r=new Yi.default;for(t!==null&&r.enqueue(t),t=r.dequeue()||null;t!=null;){if(e(t.element)===!1)return;t.leftCh!==null&&r.enqueue(t.leftCh),t.rightCh!==null&&r.enqueue(t.rightCh),t=r.dequeue()||null}},n.prototype.preorderTraversalAux=function(t,e,r){t===null||r.stop||(r.stop=e(t.element)===!1,!r.stop&&(this.preorderTraversalAux(t.leftCh,e,r),!r.stop&&this.preorderTraversalAux(t.rightCh,e,r)))},n.prototype.postorderTraversalAux=function(t,e,r){t===null||r.stop||(this.postorderTraversalAux(t.leftCh,e,r),!r.stop&&(this.postorderTraversalAux(t.rightCh,e,r),!r.stop&&(r.stop=e(t.element)===!1)))},n.prototype.minimumAux=function(t){for(;t!=null&&t.leftCh!==null;)t=t.leftCh;return t},n.prototype.maximumAux=function(t){for(;t!=null&&t.rightCh!==null;)t=t.rightCh;return t},n.prototype.heightAux=function(t){return t===null?-1:Math.max(this.heightAux(t.leftCh),this.heightAux(t.rightCh))+1},n.prototype.insertNode=function(t){for(var e=null,r=this.root;r!==null;){var i=this.compare(t.element,r.element);if(i===0)return null;i<0?(e=r,r=r.leftCh):(e=r,r=r.rightCh)}return t.parent=e,e===null?this.root=t:this.compare(t.element,e.element)<0?e.leftCh=t:e.rightCh=t,t},n.prototype.createNode=function(t){return{element:t,leftCh:null,rightCh:null,parent:null}},n}();Le.default=Xi});var vr=N(At=>{"use strict";var to=At&&At.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(At,"__esModule",{value:!0});var eo=we(),ro=function(n){to(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}return t}(eo.default);At.default=ro});var Ne=N(De=>{"use strict";Object.defineProperty(De,"__esModule",{value:!0});var Te=U(),Ot=lt(),no=function(){function n(t){this.data=[],this.compare=t||Te.defaultCompare}return n.prototype.leftChildIndex=function(t){return 2*t+1},n.prototype.rightChildIndex=function(t){return 2*t+2},n.prototype.parentIndex=function(t){return Math.floor((t-1)/2)},n.prototype.minIndex=function(t,e){return e>=this.data.length?t>=this.data.length?-1:t:this.compare(this.data[t],this.data[e])<=0?t:e},n.prototype.siftUp=function(t){for(var e=this.parentIndex(t);t>0&&this.compare(this.data[e],this.data[t])>0;)Ot.swap(this.data,e,t),t=e,e=this.parentIndex(t)},n.prototype.siftDown=function(t){for(var e=this.minIndex(this.leftChildIndex(t),this.rightChildIndex(t));e>=0&&this.compare(this.data[t],this.data[e])>0;)Ot.swap(this.data,e,t),t=e,e=this.minIndex(this.leftChildIndex(t),this.rightChildIndex(t))},n.prototype.peek=function(){if(this.data.length>0)return this.data[0]},n.prototype.add=function(t){return Te.isUndefined(t)?!1:(this.data.push(t),this.siftUp(this.data.length-1),!0)},n.prototype.removeRoot=function(){if(this.data.length>0){var t=this.data[0];return this.data[0]=this.data[this.data.length-1],this.data.splice(this.data.length-1,1),this.data.length>0&&this.siftDown(0),t}},n.prototype.contains=function(t){var e=Te.compareToEquals(this.compare);return Ot.contains(this.data,t,e)},n.prototype.size=function(){return this.data.length},n.prototype.isEmpty=function(){return this.data.length<=0},n.prototype.clear=function(){this.data.length=0},n.prototype.forEach=function(t){Ot.forEach(this.data,t)},n}();De.default=no});var _r=N(_t=>{"use strict";var io=_t&&_t.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(_t,"__esModule",{value:!0});var oo=rt(),ct=U(),ao=function(){function n(t,e){this.key=t,this.value=e}return n.prototype.unlink=function(){this.prev.next=this.next,this.next.prev=this.prev},n}(),Ar=function(){function n(){this.key=null,this.value=null}return n.prototype.unlink=function(){this.prev.next=this.next,this.next.prev=this.prev},n}();function so(n){return!n.next}var uo=function(n){io(t,n);function t(e){var r=n.call(this,e)||this;return r.head=new Ar,r.tail=new Ar,r.head.next=r.tail,r.tail.prev=r.head,r}return t.prototype.appendToTail=function(e){var r=this.tail.prev;r.next=e,e.prev=r,e.next=this.tail,this.tail.prev=e},t.prototype.getLinkedDictionaryPair=function(e){if(!ct.isUndefined(e)){var r="$"+this.toStr(e),i=this.table[r];return i}},t.prototype.getValue=function(e){var r=this.getLinkedDictionaryPair(e);if(!ct.isUndefined(r))return r.value},t.prototype.remove=function(e){var r=this.getLinkedDictionaryPair(e);if(!ct.isUndefined(r))return n.prototype.remove.call(this,e),r.unlink(),r.value},t.prototype.clear=function(){n.prototype.clear.call(this),this.head.next=this.tail,this.tail.prev=this.head},t.prototype.replace=function(e,r){var i="$"+this.toStr(r.key);r.next=e.next,r.prev=e.prev,this.remove(e.key),r.prev.next=r,r.next.prev=r,this.table[i]=r,++this.nElements},t.prototype.setValue=function(e,r){if(!(ct.isUndefined(e)||ct.isUndefined(r))){var i=this.getLinkedDictionaryPair(e),s=new ao(e,r),l="$"+this.toStr(e);if(ct.isUndefined(i)){this.appendToTail(s),this.table[l]=s,++this.nElements;return}else return this.replace(i,s),i.value}},t.prototype.keys=function(){var e=[];return this.forEach(function(r,i){e.push(r)}),e},t.prototype.values=function(){var e=[];return this.forEach(function(r,i){e.push(i)}),e},t.prototype.forEach=function(e){for(var r=this.head.next;!so(r);){var i=e(r.key,r.value);if(i===!1)return;r=r.next}},t}(oo.default);_t.default=uo});var gr=N(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});var Z=U(),lo=rt(),Ie=lt(),co=function(){function n(t,e,r){r===void 0&&(r=!1),this.dict=new lo.default(t),this.equalsF=e||Z.defaultEquals,this.allowDuplicate=r}return n.prototype.getValue=function(t){var e=this.dict.getValue(t);return Z.isUndefined(e)?[]:Ie.copy(e)},n.prototype.setValue=function(t,e){if(Z.isUndefined(t)||Z.isUndefined(e))return!1;var r=this.dict.getValue(t);return Z.isUndefined(r)?(this.dict.setValue(t,[e]),!0):!this.allowDuplicate&&Ie.contains(r,e,this.equalsF)?!1:(r.push(e),!0)},n.prototype.remove=function(t,e){if(Z.isUndefined(e)){var r=this.dict.remove(t);return!Z.isUndefined(r)}var i=this.dict.getValue(t);return!Z.isUndefined(i)&&Ie.remove(i,e,this.equalsF)?(i.length===0&&this.dict.remove(t),!0):!1},n.prototype.keys=function(){return this.dict.keys()},n.prototype.values=function(){for(var t=this.dict.values(),e=[],r=0,i=t;r<i.length;r++)for(var s=i[r],l=0,p=s;l<p.length;l++){var f=p[l];e.push(f)}return e},n.prototype.containsKey=function(t){return this.dict.containsKey(t)},n.prototype.clear=function(){this.dict.clear()},n.prototype.size=function(){return this.dict.size()},n.prototype.isEmpty=function(){return this.dict.isEmpty()},n}();Ve.default=co});var ke=N(gt=>{"use strict";var fo=gt&&gt.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(gt,"__esModule",{value:!0});var ho=rt(),po=U(),mo=function(n){fo(t,n);function t(e,r){var i=n.call(this,r)||this;return i.defaultFactoryFunction=e,i}return t.prototype.setDefault=function(e,r){var i=n.prototype.getValue.call(this,e);return po.isUndefined(i)?(this.setValue(e,r),r):i},t.prototype.getValue=function(e){return this.setDefault(e,this.defaultFactoryFunction())},t}(ho.default);gt.default=mo});var br=N(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});var yo=U(),vo=Ne(),Ao=function(){function n(t){this.heap=new vo.default(yo.reverseCompareFunction(t))}return n.prototype.enqueue=function(t){return this.heap.add(t)},n.prototype.add=function(t){return this.heap.add(t)},n.prototype.dequeue=function(){if(this.heap.size()!==0){var t=this.heap.peek();return this.heap.removeRoot(),t}},n.prototype.peek=function(){return this.heap.peek()},n.prototype.contains=function(t){return this.heap.contains(t)},n.prototype.isEmpty=function(){return this.heap.isEmpty()},n.prototype.size=function(){return this.heap.size()},n.prototype.clear=function(){this.heap.clear()},n.prototype.forEach=function(t){this.heap.forEach(t)},n}();Fe.default=Ao});var Cr=N(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});var _o=qt(),go=function(){function n(){this.list=new _o.default}return n.prototype.push=function(t){return this.list.add(t,0)},n.prototype.add=function(t){return this.list.add(t,0)},n.prototype.pop=function(){return this.list.removeElementAtIndex(0)},n.prototype.peek=function(){return this.list.first()},n.prototype.size=function(){return this.list.size()},n.prototype.contains=function(t,e){return this.list.contains(t,e)},n.prototype.isEmpty=function(){return this.list.isEmpty()},n.prototype.clear=function(){this.list.clear()},n.prototype.forEach=function(t){this.list.forEach(t)},n}();qe.default=go});var Sr=N(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});var T;(function(n){n[n.BEFORE=0]="BEFORE",n[n.AFTER=1]="AFTER",n[n.INSIDE_AT_END=2]="INSIDE_AT_END",n[n.INSIDE_AT_START=3]="INSIDE_AT_START"})(T||(T={}));var bo=function(){function n(t,e){t===void 0&&(t=[]),e===void 0&&(e={}),this.rootIds=t,this.nodes=e,this.initRootIds(),this.initNodes()}return n.prototype.initRootIds=function(){for(var t=0,e=this.rootIds;t<e.length;t++){var r=e[t];this.createEmptyNodeIfNotExist(r)}},n.prototype.initNodes=function(){for(var t in this.nodes)if(this.nodes.hasOwnProperty(t))for(var e=0,r=this.nodes[t];e<r.length;e++){var i=r[e];this.createEmptyNodeIfNotExist(i)}},n.prototype.createEmptyNodeIfNotExist=function(t){this.nodes[t]||(this.nodes[t]=[])},n.prototype.getRootIds=function(){var t=this.rootIds.slice();return t},n.prototype.getNodes=function(){var t={};for(var e in this.nodes)this.nodes.hasOwnProperty(e)&&(t[e]=this.nodes[e].slice());return t},n.prototype.getObject=function(){return{rootIds:this.getRootIds(),nodes:this.getNodes()}},n.prototype.toObject=function(){return this.getObject()},n.prototype.flatten=function(){for(var t=this,e=[],r=0;r<this.rootIds.length;r++){var i=this.rootIds[r];e.push({id:i,level:0,hasParent:!1,childrenCount:0}),d(i,this.nodes,e,0)}for(var s=0,l=e;s<l.length;s++){var p=l[s];p.childrenCount=f(p.id)}return e;function f(m){if(t.nodes[m]){var g=t.nodes[m].length;return g}else return 0}function d(m,g,b,_){if(_===void 0&&(_=0),!(!m||!g||!b||!g[m])){_++;for(var z=g[m],J=0;J<z.length;J++){var st=z[J];b.push({id:st,level:_,hasParent:!0}),d(st,g,b,_)}_--}}},n.prototype.moveIdBeforeId=function(t,e){return this.moveId(t,e,T.BEFORE)},n.prototype.moveIdAfterId=function(t,e){return this.moveId(t,e,T.AFTER)},n.prototype.moveIdIntoId=function(t,e,r){return r===void 0&&(r=!0),r?this.moveId(t,e,T.INSIDE_AT_START):this.moveId(t,e,T.INSIDE_AT_END)},n.prototype.swapRootIdWithRootId=function(t,e){var r=this.findRootId(t),i=this.findRootId(e);this.swapRootPositionWithRootPosition(r,i)},n.prototype.swapRootPositionWithRootPosition=function(t,e){var r=this.rootIds[e];this.rootIds[e]=this.rootIds[t],this.rootIds[t]=r},n.prototype.deleteId=function(t){this.rootDeleteId(t),this.nodeAndSubNodesDelete(t),this.nodeRefrencesDelete(t)},n.prototype.insertIdBeforeId=function(t,e){var r=this.findRootId(t);r>-1&&this.insertIdIntoRoot(e,r);for(var i in this.nodes)if(this.nodes.hasOwnProperty(i)){var s=this.findNodeId(i,t);s>-1&&this.insertIdIntoNode(i,e,s)}},n.prototype.insertIdAfterId=function(t,e){var r=this.findRootId(t);r>-1&&this.insertIdIntoRoot(e,r+1);for(var i in this.nodes)if(this.nodes.hasOwnProperty(i)){var s=this.findNodeId(i,t);s>-1&&this.insertIdIntoNode(i,e,s+1)}},n.prototype.insertIdIntoId=function(t,e){this.nodeInsertAtEnd(t,e),this.nodes[e]=[]},n.prototype.insertIdIntoRoot=function(t,e){if(e===void 0)this.rootInsertAtEnd(t);else if(e<0){var r=this.rootIds.length;this.rootIds.splice(e+r+1,0,t)}else this.rootIds.splice(e,0,t);this.nodes[t]=this.nodes[t]||[]},n.prototype.insertIdIntoNode=function(t,e,r){if(this.nodes[t]=this.nodes[t]||[],this.nodes[e]=this.nodes[e]||[],r===void 0)this.nodeInsertAtEnd(t,e);else if(r<0){var i=this.nodes[t].length;this.nodes[t].splice(r+i+1,0,e)}else this.nodes[t].splice(r,0,e)},n.prototype.moveId=function(t,e,r){var i=t,s=this.findRootId(i),l,p;this.nodes[e]&&(l=e);for(var f in this.nodes)if(this.nodes.hasOwnProperty(f)){p=this.findNodeId(f,e);break}var d=e,m=this.findRootId(d),g,b;this.nodes[e]&&(g=e);for(var f in this.nodes)if(this.nodes.hasOwnProperty(f)){b=this.findNodeId(f,e);break}if(s>-1)if(m>-1)switch(this.rootDelete(s),m>s&&m--,r){case T.BEFORE:this.insertIdIntoRoot(i,m);break;case T.AFTER:this.insertIdIntoRoot(i,m+1);break;case T.INSIDE_AT_START:this.nodeInsertAtStart(d,i);break;case T.INSIDE_AT_END:this.nodeInsertAtEnd(d,i);break}else{this.rootDelete(s);for(var f in this.nodes)if(this.nodes.hasOwnProperty(f)){var _=this.findNodeId(f,d);if(_>-1){switch(r){case T.BEFORE:this.insertIdIntoNode(f,i,_);break;case T.AFTER:this.insertIdIntoNode(f,i,_+1);break;case T.INSIDE_AT_START:this.nodeInsertAtStart(d,i);break;case T.INSIDE_AT_END:this.nodeInsertAtEnd(d,i);break}break}}}else if(m>-1){for(var f in this.nodes)if(this.nodes.hasOwnProperty(f)){var _=this.findNodeId(f,i);if(_>-1){this.nodeDeleteAtIndex(f,_);break}}switch(r){case T.BEFORE:this.insertIdIntoRoot(i,m);break;case T.AFTER:this.insertIdIntoRoot(i,m+1);break;case T.INSIDE_AT_START:this.nodeInsertAtStart(d,i);break;case T.INSIDE_AT_END:this.nodeInsertAtEnd(d,i);break}}else{for(var f in this.nodes)if(this.nodes.hasOwnProperty(f)){var _=this.findNodeId(f,i);if(_>-1){this.nodeDeleteAtIndex(f,_);break}}for(var f in this.nodes)if(this.nodes.hasOwnProperty(f)){var _=this.findNodeId(f,d);if(_>-1){switch(r){case T.BEFORE:this.insertIdIntoNode(f,i,_);break;case T.AFTER:this.insertIdIntoNode(f,i,_+1);break;case T.INSIDE_AT_START:this.nodeInsertAtStart(d,i);break;case T.INSIDE_AT_END:this.nodeInsertAtEnd(d,i);break}break}}}},n.prototype.swapArrayElements=function(t,e,r){var i=t[e];return t[e]=t[r],t[r]=i,t},n.prototype.rootDeleteId=function(t){var e=this.findRootId(t);e>-1&&this.rootDelete(e)},n.prototype.nodeAndSubNodesDelete=function(t){for(var e=[],r=0;r<this.nodes[t].length;r++){var i=this.nodes[t][r];this.nodeAndSubNodesDelete(i),e.push(t)}this.nodeDelete(t);for(var r=0;r<e.length;r++)this.nodeDelete(e[r])},n.prototype.nodeRefrencesDelete=function(t){for(var e in this.nodes)if(this.nodes.hasOwnProperty(e))for(var r=0;r<this.nodes[e].length;r++){var i=this.nodes[e][r];i===t&&this.nodeDeleteAtIndex(e,r)}},n.prototype.nodeDelete=function(t){delete this.nodes[t]},n.prototype.findRootId=function(t){return this.rootIds.indexOf(t)},n.prototype.findNodeId=function(t,e){return this.nodes[t].indexOf(e)},n.prototype.findNode=function(t){return this.nodes[t]},n.prototype.nodeInsertAtStart=function(t,e){this.nodes[t].unshift(e)},n.prototype.nodeInsertAtEnd=function(t,e){this.nodes[t].push(e)},n.prototype.rootDelete=function(t){this.rootIds.splice(t,1)},n.prototype.nodeDeleteAtIndex=function(t,e){this.nodes[t].splice(e,1)},n.prototype.rootInsertAtStart=function(t){this.rootIds.unshift(t)},n.prototype.rootInsertAtEnd=function(t){this.rootIds.push(t)},n}();Oe.default=bo});var bt=N(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});var Co=lt();I.arrays=Co;var So=yr();I.Bag=So.default;var xo=vr();I.BSTree=xo.default;var Eo=we();I.BSTreeKV=Eo.default;var Bo=rt();I.Dictionary=Bo.default;var Lo=Ne();I.Heap=Lo.default;var wo=_r();I.LinkedDictionary=wo.default;var To=qt();I.LinkedList=To.default;var Do=gr();I.MultiDictionary=Do.default;var No=ke();I.FactoryDictionary=No.default;var Io=ke();I.DefaultDictionary=Io.default;var Vo=Ee();I.Queue=Vo.default;var ko=br();I.PriorityQueue=ko.default;var Fo=ge();I.Set=Fo.default;var qo=Cr();I.Stack=qo.default;var Oo=Sr();I.MultiRootTree=Oo.default;var $o=U();I.util=$o});var Br=N((Wa,te)=>{(function(n){"use strict";typeof te=="object"&&typeof te.exports=="object"?te.exports=n():typeof define=="function"&&define.amd!=null?define([],n):self.sanctuaryTypeIdentifiers=n()})(function(){"use strict";var n="@@type";function t(e){return e!=null&&e.constructor!=null&&e.constructor.prototype!==e&&typeof e.constructor[n]=="string"?e.constructor[n]:Object.prototype.toString.call(e).slice("[object ".length,-"]".length)}return t})});var Lr=N((Ha,ee)=>{(function(n){"use strict";typeof ee=="object"&&typeof ee.exports=="object"?ee.exports=n(Br()):typeof define=="function"&&define.amd!=null?define(["sanctuary-type-identifiers"],n):self.sanctuaryTypeClasses=n(self.sanctuaryTypeIdentifiers)})(function(n){"use strict";if(typeof __doctest!="undefined")var t=__doctest.require("./test/Identity"),e=__doctest.require("./test/List"),r=__doctest.require("./test/Maybe"),i=__doctest.require("./test/Sum"),s=__doctest.require("./test/Tuple"),l=e.Nil,p=e.Cons,f=r.Nothing,d=r.Just;function m(o){return function(a){return o.concat(a)}}function g(o){return function(a){return o}}function b(o,a){Object.keys(o).forEach(a,o)}function _(o,a){return Object.prototype.hasOwnProperty.call(a,o)}function z(o){return o}function J(o){return function(a){return[o,a]}}function st(o,a){return typeof o==typeof a&&n(o)===n(a)}function $r(o){return function(a){return a(o)}}function ae(o){return{value:o,done:!1}}function Ge(o){return{value:o,done:!0}}function dt(o,a,u,c){if(!(this instanceof dt))return new dt(o,a,u,c);this.name=o,this.url=a,this.test=function(v){return u.every(function(B){return B.test(v)})&&c(v)}}dt["@@type"]="sanctuary-type-classes/TypeClass";var Y="Constructor",k="Value";function We(o,a,u){for(var c=u,v=0;v<a.length;v+=1){var B=a[v];if(c==null||!(o||_(B,c)))return null;c=c[B]}return typeof c=="function"?c:null}function He(o,a){return We(!0,o,a)}function Ke(o){return We(!1,o,zn)}var zr=_("name",function(){})?function(a){return a.name}:function(a){var u=/function (\w*)/.exec(a);return u==null?"":u[1]};function w(o,a,u){function c(L){var C="fantasy-land/"+L;return u[L]===Y?function(F){var Vt=He([C],F);return Vt==null&&typeof F=="function"?Ke([zr(F),C]):Vt}:function(F){var Vt=F!=null&&F.constructor!=null&&F.constructor.prototype===F,yt=null;return Vt||(yt=He([C],F)),yt==null&&(yt=Ke([n(F),"prototype",C])),yt&&yt.bind(F)}}var v="9.0.0",B=Object.keys(u),O=dt("sanctuary-type-classes/"+o,"https://github.com/sanctuary-js/sanctuary-type-classes/tree/v"+v+"#"+o,a,function(L){return B.every(function(C){var F=u[C]===Y?L.constructor:L;return c(C)(F)!=null})});return O.methods=B.reduce(function(L,C){return L[C]=c(C),L},{}),O}var mt=w("Setoid",[],{equals:k}),Et=w("Ord",[mt],{lte:k}),se=w("Semigroupoid",[],{compose:k}),Ze=w("Category",[se],{id:Y}),ue=w("Semigroup",[],{concat:k}),le=w("Monoid",[ue],{empty:Y}),Je=w("Group",[le],{invert:k}),Ye=w("Filterable",[],{filter:k}),K=w("Functor",[],{map:k}),Xe=w("Bifunctor",[K],{bimap:k}),tr=w("Profunctor",[K],{promap:k}),Bt=w("Apply",[K],{ap:k}),Lt=w("Applicative",[Bt],{of:Y}),wt=w("Chain",[Bt],{chain:k}),er=w("ChainRec",[wt],{chainRec:Y}),Rr=w("Monad",[Lt,wt],{}),ce=w("Alt",[K],{alt:k}),fe=w("Plus",[ce],{zero:Y}),jr=w("Alternative",[Lt,fe],{}),he=w("Foldable",[],{reduce:k}),rr=w("Traversable",[K,he],{traverse:k}),pe=w("Extend",[K],{extend:k}),nr=w("Comonad",[pe],{extract:k}),ir=w("Contravariant",[],{contramap:k});function Ur(o){return!0}function Pr(o){return!0}function Mr(o){return!0}function Qr(o){return!0}function Gr(o){return typeof this=="object"?R(this.valueOf(),o.valueOf()):this===o}function Wr(o){return typeof this=="object"?M(this.valueOf(),o.valueOf()):this===!1||o===!0}function Hr(o){return typeof this=="object"?R(this.valueOf(),o.valueOf()):isNaN(this)&&isNaN(o)||this===o}function Kr(o){return typeof this=="object"?M(this.valueOf(),o.valueOf()):isNaN(this)||this<=o}function Zr(o){return R(this.valueOf(),o.valueOf())}function Jr(o){return M(this.valueOf(),o.valueOf())}function Yr(o){return o.source===this.source&&o.global===this.global&&o.ignoreCase===this.ignoreCase&&o.multiline===this.multiline&&o.sticky===this.sticky&&o.unicode===this.unicode}function Xr(){return""}function tn(o){return typeof this=="object"?R(this.valueOf(),o.valueOf()):this===o}function en(o){return typeof this=="object"?M(this.valueOf(),o.valueOf()):this<=o}function rn(o){return this+o}function nn(){return[]}function or(o){return[o]}function on(o,a){for(var u=[],c={},v={head:a,tail:c};v!==c;){for(var B=c,O=o(ae,Ge,v.head),L=0;L<O.length;L+=1){var C=O[L];C.done?u.push(C.value):B={head:C.value,tail:B}}for(v=v.tail;B!==c;)v={head:B.head,tail:v},B=B.tail}return u}function an(){return[]}function ar(o){if(o.length!==this.length)return!1;for(var a=0;a<this.length;a+=1)if(!R(this[a],o[a]))return!1;return!0}function sr(o){for(var a=0;;a+=1){if(a===this.length)return!0;if(a===o.length)return!1;if(!R(this[a],o[a]))return M(this[a],o[a])}}function ur(o){return this.concat(o)}function sn(o){return this.filter(function(a){return o(a)})}function un(o){return this.map(function(a){return o(a)})}function ln(o){for(var a=[],u=0;u<o.length;u+=1)for(var c=0;c<this.length;c+=1)a.push(o[u](this[c]));return a}function cn(o){for(var a=[],u=0;u<this.length;u+=1)for(var c=0,v=o(this[u]);c<v.length;c+=1)a.push(v[c]);return a}var fn=ur;function hn(o,a){for(var u=a,c=0;c<this.length;c+=1)u=o(u,this[c]);return u}function pn(o,a){var u=this;function c(v,B){switch(B){case 0:return et(o,[]);case 2:return tt(J,a(u[v]),a(u[v+1]));default:var O=Math.floor(B/4)*2;return tt(m,c(v,O),c(v+O,B-O))}}return this.length%2==1?tt(m,Nt(or,a(this[0])),c(1,this.length-1)):c(0,this.length)}function dn(o){return this.map(function(a,u,c){return o(c.slice(u))})}function mn(o){return ar.call(this,o)}function yn(o){return sr.call(this,o)}function vn(o){return R(this.name,o.name)&&R(this.message,o.message)}function An(){return{}}function _n(){return{}}function gn(o){var a=this,u=Object.keys(this).sort();return R(u,Object.keys(o).sort())&&u.every(function(c){return R(a[c],o[c])})}function bn(o){for(var a=Object.keys(this).sort(),u=Object.keys(o).sort();;){if(a.length===0)return!0;if(u.length===0)return!1;var c=a.shift(),v=u.shift();if(c<v)return!0;if(c>v)return!1;if(!R(this[c],o[c]))return M(this[c],o[c])}}function de(o){var a={};function u(c){a[c]=this[c]}return b(this,u),b(o,u),a}function Cn(o){var a={};return b(this,function(u){o(this[u])&&(a[u]=this[u])}),a}function Sn(o){var a={};return b(this,function(u){a[u]=o(this[u])}),a}function xn(o){var a={};return b(this,function(u){_(u,o)&&(a[u]=o[u](this[u]))}),a}var En=de;function Bn(o,a){var u=this;function c(v,B){return o(v,u[B])}return Object.keys(this).sort().reduce(c,a)}function Ln(o,a){var u=this;return Object.keys(this).reduce(function(c,v){function B(O){return function(L){var C={};return C[v]=L,de.call(O,C)}}return tt(B,c,a(u[v]))},et(o,{}))}function wn(){return z}function Tn(o){return function(a){return o}}function Dn(o,a){return function(u){for(var c=ae(a);!c.done;)c=o(ae,Ge,c.value)(u);return c.value}}function Nn(o){return o===this}function In(o){var a=this;return function(u){return o(a(u))}}function Vn(o){var a=this;return function(u){return o(a(u))}}function kn(o,a){var u=this;return function(c){return a(u(o(c)))}}function Fn(o){var a=this;return function(u){return o(u)(a(u))}}function qn(o){var a=this;return function(u){return o(a(u))(u)}}function On(o){var a=this;return function(u){return o(function(c){return a(X(u,c))})}}function $n(o){var a=this;return function(u){return a(o(u))}}var zn={Null:{prototype:{"fantasy-land/equals":Ur,"fantasy-land/lte":Pr}},Undefined:{prototype:{"fantasy-land/equals":Mr,"fantasy-land/lte":Qr}},Boolean:{prototype:{"fantasy-land/equals":Gr,"fantasy-land/lte":Wr}},Number:{prototype:{"fantasy-land/equals":Hr,"fantasy-land/lte":Kr}},Date:{prototype:{"fantasy-land/equals":Zr,"fantasy-land/lte":Jr}},RegExp:{prototype:{"fantasy-land/equals":Yr}},String:{"fantasy-land/empty":Xr,prototype:{"fantasy-land/equals":tn,"fantasy-land/lte":en,"fantasy-land/concat":rn}},Array:{"fantasy-land/empty":nn,"fantasy-land/of":or,"fantasy-land/chainRec":on,"fantasy-land/zero":an,prototype:{"fantasy-land/equals":ar,"fantasy-land/lte":sr,"fantasy-land/concat":ur,"fantasy-land/filter":sn,"fantasy-land/map":un,"fantasy-land/ap":ln,"fantasy-land/chain":cn,"fantasy-land/alt":fn,"fantasy-land/reduce":hn,"fantasy-land/traverse":pn,"fantasy-land/extend":dn}},Arguments:{prototype:{"fantasy-land/equals":mn,"fantasy-land/lte":yn}},Error:{prototype:{"fantasy-land/equals":vn}},Object:{"fantasy-land/empty":An,"fantasy-land/zero":_n,prototype:{"fantasy-land/equals":gn,"fantasy-land/lte":bn,"fantasy-land/concat":de,"fantasy-land/filter":Cn,"fantasy-land/map":Sn,"fantasy-land/ap":xn,"fantasy-land/alt":En,"fantasy-land/reduce":Bn,"fantasy-land/traverse":Ln}},Function:{"fantasy-land/id":wn,"fantasy-land/of":Tn,"fantasy-land/chainRec":Dn,prototype:{"fantasy-land/equals":Nn,"fantasy-land/compose":In,"fantasy-land/map":Vn,"fantasy-land/promap":kn,"fantasy-land/ap":Fn,"fantasy-land/chain":qn,"fantasy-land/extend":On,"fantasy-land/contramap":$n}}},R=function(){var o=[];return function(u,c){if(!st(u,c))return!1;if(o.some(function(v){return v[0]===u&&v[1]===c}))return!0;o.push([u,c]);try{return mt.test(u)&&mt.test(c)&&mt.methods.equals(u)(c)}finally{o.pop()}}}();function lr(o,a){return st(o,a)&&!M(a,o)}var M=function(){var o=[];return function(u,c){if(!st(u,c))return!1;if(o.some(function(v){return v[0]===u&&v[1]===c}))return R(u,c);o.push([u,c]);try{return Et.test(u)&&Et.test(c)&&Et.methods.lte(u)(c)}finally{o.pop()}}}();function Rn(o,a){return lr(a,o)}function jn(o,a){return M(a,o)}function Un(o,a){return M(o,a)?o:a}function Pn(o,a){return M(o,a)?a:o}function Mn(o,a){return se.methods.compose(a)(o)}function Qn(o){return Ze.methods.id(o)()}function X(o,a){return ue.methods.concat(o)(a)}function Tt(o){return le.methods.empty(o)()}function Gn(o){return Je.methods.invert(o)()}function Dt(o,a){return Ye.methods.filter(a)(o)}function Wn(o,a){return Dt(function(u){return!o(u)},a)}function Hn(o,a){var u=!0;return Dt(function(c){return u=u&&o(c)},a)}function Kn(o,a){var u=!1;return Dt(function(c){return u=u||!o(c)},a)}function Nt(o,a){return K.methods.map(a)(o)}function Zn(o,a){return K.methods.map(o)($r(a))}function cr(o,a,u){return Xe.methods.bimap(u)(o,a)}function Jn(o,a){return cr(o,z,a)}function Yn(o,a,u){return tr.methods.promap(u)(o,a)}function It(o,a){return Bt.methods.ap(a)(o)}function tt(o,a,u){return It(Nt(o,a),u)}function Xn(o,a,u,c){return It(It(Nt(o,a),u),c)}function ti(o,a){return tt(g,o,a)}function ei(o,a){return tt(g(z),o,a)}function et(o,a){return Lt.methods.of(o)(a)}function ri(o,a){return X(a,et(a.constructor,o))}function ni(o,a){return X(et(a.constructor,o),a)}function fr(o,a){return wt.methods.chain(a)(o)}function ii(o){return fr(z,o)}function oi(o,a,u){return er.methods.chainRec(o)(a,u)}function ai(o,a){return ce.methods.alt(o)(a)}function si(o){return fe.methods.zero(o)()}function ut(o,a,u){return he.methods.reduce(u)(o,a)}function ui(o){return Array.isArray(o)?o.length:ut(function(a,u){return a+1},0,o)}function li(o,a){return ut(function(u,c){return u||R(o,c)},!1,a)}function ci(o,a,u){return ut(function(c,v){return X(c,a(v))},Tt(o),u)}function fi(o){if(Array.isArray(o))return o.slice().reverse();var a=o.constructor;return ut(function(u,c){return X(et(a,c),u)},Tt(a),o)}function hi(o){return hr(z,o)}function hr(o,a){var u=ut(function(L,C){return L.push({idx:L.length,x:C,fx:o(C)}),L},[],a),c=function(L){switch(typeof(L&&L.fx)){case"number":return function(C,F){return C<=F||C!==C};case"string":return function(C,F){return C<=F};default:return M}}(u[0]);if(u.sort(function(L,C){return c(L.fx,C.fx)?c(C.fx,L.fx)?L.idx-C.idx:-1:1}),Array.isArray(a)){for(var v=0;v<u.length;v+=1)u[v]=u[v].x;return u}var B=a.constructor,O=Tt(B);for(v=0;v<u.length;v+=1)O=X(O,et(B,u[v].x));return O}function pr(o,a,u){return rr.methods.traverse(u)(o,a)}function pi(o,a){return pr(o,z,a)}function dr(o,a){return pe.methods.extend(a)(o)}function di(o){return dr(z,o)}function mi(o){return nr.methods.extract(o)()}function yi(o,a){return ir.methods.contramap(a)(o)}return{TypeClass:dt,Setoid:mt,Ord:Et,Semigroupoid:se,Category:Ze,Semigroup:ue,Monoid:le,Group:Je,Filterable:Ye,Functor:K,Bifunctor:Xe,Profunctor:tr,Apply:Bt,Applicative:Lt,Chain:wt,ChainRec:er,Monad:Rr,Alt:ce,Plus:fe,Alternative:jr,Foldable:he,Traversable:rr,Extend:pe,Comonad:nr,Contravariant:ir,equals:R,lt:lr,lte:M,gt:Rn,gte:jn,min:Un,max:Pn,compose:Mn,id:Qn,concat:X,empty:Tt,invert:Gn,filter:Dt,reject:Wn,map:Nt,flip:Zn,bimap:cr,mapLeft:Jn,promap:Yn,ap:It,lift2:tt,lift3:Xn,apFirst:ti,apSecond:ei,of:et,append:ri,prepend:ni,chain:fr,join:ii,chainRec:oi,alt:ai,zero:si,reduce:ut,size:ui,elem:li,foldMap:ci,reverse:fi,sort:hi,sortBy:hr,takeWhile:Hn,dropWhile:Kn,traverse:pr,sequence:pi,extend:dr,duplicate:di,extract:mi,contramap:yi}})});var $t=vt(bt()),ze=class{constructor(t,e){this.rank=t,this.action=e,this.seq=ze.nextSeq++}toString(){return this.seq.toString()}},$e=ze;$e.nextSeq=0;var E=class{constructor(){this.inCallback=0;this.toRegen=!1;this.prioritizedQ=new $t.PriorityQueue((t,e)=>t.rank.rank<e.rank.rank?1:t.rank.rank>e.rank.rank?-1:t.seq<e.seq?1:t.seq>e.seq?-1:0);this.entries=new $t.Set(t=>t.toString());this.sampleQ=[];this.lastQ=[];this.postQ=null}requestRegen(){this.toRegen=!0}prioritized(t,e){let r=new $e(t,e);this.prioritizedQ.enqueue(r),this.entries.add(r)}sample(t){this.sampleQ.push(t)}last(t){this.lastQ.push(t)}static _collectCyclesAtEnd(){E.run(()=>E.collectCyclesAtEnd=!0)}post(t,e){for(this.postQ==null&&(this.postQ=[]);this.postQ.length<=t;)this.postQ.push(null);let r=this.postQ[t],i=r===null?e:()=>{r(),e()};this.postQ[t]=i}checkRegen(){if(this.toRegen){this.toRegen=!1,this.prioritizedQ.clear();let t=this.entries.toArray();for(let e=0;e<t.length;e++)this.prioritizedQ.enqueue(t[e])}}isActive(){return!!E.currentTransaction}close(){for(;;){for(;this.checkRegen(),!this.prioritizedQ.isEmpty();){let e=this.prioritizedQ.dequeue();this.entries.remove(e),e.action()}let t=this.sampleQ;this.sampleQ=[];for(let e=0;e<t.length;e++)t[e]();if(this.prioritizedQ.isEmpty()&&this.sampleQ.length<1)break}for(let t=0;t<this.lastQ.length;t++)this.lastQ[t]();if(this.lastQ=[],this.postQ!=null){for(let t=0;t<this.postQ.length;t++)if(this.postQ[t]!=null){let e=E.currentTransaction;try{if(t>0){E.currentTransaction=new E;try{this.postQ[t](),E.currentTransaction.close()}catch(r){throw E.currentTransaction.close(),r}}else E.currentTransaction=null,this.postQ[t]();E.currentTransaction=e}catch(r){throw E.currentTransaction=e,r}}this.postQ=null}}static onStart(t){E.onStartHooks.push(t)}static run(t){let e=E.currentTransaction;if(e===null){if(!E.runningOnStartHooks){E.runningOnStartHooks=!0;try{for(let r=0;r<E.onStartHooks.length;r++)E.onStartHooks[r]()}finally{E.runningOnStartHooks=!1}}E.currentTransaction=new E}try{let r=t();return e===null&&(E.currentTransaction.close(),E.currentTransaction=null,E.collectCyclesAtEnd&&(A.collectCycles(),E.collectCyclesAtEnd=!1)),r}catch(r){throw e===null&&(E.currentTransaction.close(),E.currentTransaction=null),r}}},h=E;h.currentTransaction=null,h.onStartHooks=[],h.runningOnStartHooks=!1,h.collectCyclesAtEnd=!1;var Re=vt(bt()),je=0;function zo(){return je}var y=class{constructor(t,e){this.registered=!1;this.deregister_=null;if(t===null)throw new Error("null origin!");this.origin=t,this.register_=e}register(t){this.registered||(this.registered=!0,this.register_!==null?this.deregister_=this.register_():(this.origin.increment(A.NULL),t.childrn.push(this.origin),this.deregister_=()=>{this.origin.decrement(A.NULL);for(let e=t.childrn.length-1;e>=0;--e)if(t.childrn[e]===this.origin){t.childrn.splice(e,1);break}}))}deregister(t){this.registered&&(this.registered=!1,this.deregister_!==null&&this.deregister_())}},D;(function(i){i[i.black=0]="black",i[i.gray=1]="gray",i[i.white=2]="white",i[i.purple=3]="purple"})(D||(D={}));var V=[],Ro=0,H=!1;var P=class{constructor(t,e,r){this.targets=[];this.childrn=[];this.visited=!1;this.color=0;this.buffered=!1;this.refCountAdj=0;this.name=t,this.rank=e,this.sources=r,this.id=Ro++}refCount(){return this.targets.length}register(t){return this.increment(t)}deregister(t){H&&console.log("deregister "+this.descr()+" => "+t.descr()),this.decrement(t),h._collectCyclesAtEnd()}incRefCount(t){let e=!1;if(this.refCount()==0)for(let r=0;r<this.sources.length;r++)this.sources[r].register(this);return this.targets.push(t),t.childrn.push(this),t.ensureBiggerThan(this.rank)&&(e=!0),je++,e}decRefCount(t){H&&console.log("DEC "+this.descr());let e=!1;for(let r=t.childrn.length-1;r>=0;r--)if(t.childrn[r]===this){t.childrn.splice(r,1);break}for(let r=0;r<this.targets.length;r++)if(this.targets[r]===t){this.targets.splice(r,1),e=!0;break}if(e){if(this.refCount()==0)for(let r=0;r<this.sources.length;r++)this.sources[r].deregister(this);je--}}addSource(t){this.sources.push(t),this.refCount()>0&&t.register(this)}ensureBiggerThan(t){if(this.visited||this.rank>t)return!1;this.visited=!0,this.rank=t+1;for(let e=0;e<this.targets.length;e++)this.targets[e].ensureBiggerThan(this.rank);return this.visited=!1,!0}descr(){let t=null;switch(this.color){case 0:t="black";break;case 1:t="gray";break;case 2:t="white";break;case 3:t="purple";break}let e=this.id+" "+this.name+" ["+this.refCount()+"/"+this.refCountAdj+"] "+t+" ->",r=this.children();for(let i=0;i<r.length;i++)e=e+" "+r[i].id;return e}children(){return this.childrn}increment(t){return this.incRefCount(t)}decrement(t){this.decRefCount(t),this.refCount()==0?this.release():this.possibleRoots()}release(){this.color=0,this.buffered||this.free()}free(){for(;this.targets.length>0;)this.decRefCount(this.targets[0])}possibleRoots(){this.color!=3&&(this.color=3,this.buffered||(this.buffered=!0,V.push(this)))}static collectCycles(){if(!P.collectingCycles)try{P.collectingCycles=!0,P.markRoots(),P.scanRoots(),P.collectRoots();for(let t=P.toBeFreedList.length-1;t>=0;--t)P.toBeFreedList.splice(t,1)[0].free()}finally{P.collectingCycles=!1}}static markRoots(){let t=[];if(H){let e=V.slice(0),r=new Re.Set;for(;e.length!=0;){let i=e.pop();if(!r.contains(i.id)){r.add(i.id),i.refCountAdj!=0&&console.log("markRoots(): reachable refCountAdj was not reset to zero: "+i.descr());for(let s=0;s<i.childrn.length;++s){let l=i.childrn[s];e.push(l)}}}}for(let e=0;e<V.length;e++)H&&console.log("markRoots "+V[e].descr()),V[e].color==3?(V[e].markGray(),t.push(V[e])):(V[e].buffered=!1,V[e].color==0&&V[e].refCount()==0&&P.toBeFreedList.push(V[e]));V=t}static scanRoots(){for(let t=0;t<V.length;t++)V[t].scan()}static collectRoots(){for(let t=0;t<V.length;t++)V[t].buffered=!1,V[t].collectWhite();if(H){let t=V.slice(0),e=new Re.Set;for(;t.length!=0;){let r=t.pop();if(!e.contains(r.id)){e.add(r.id),r.refCountAdj!=0&&console.log("collectRoots(): reachable refCountAdj was not reset to zero: "+r.descr());for(let i=0;i<r.childrn.length;++i){let s=r.childrn[i];t.push(s)}}}}V=[]}markGray(){if(this.color!=1){this.color=1;let t=this.children();for(let e=0;e<t.length;e++)t[e].refCountAdj--,H&&console.log("markGray "+this.descr()),t[e].markGray()}}scan(){if(H&&console.log("scan "+this.descr()),this.color==1)if(this.refCount()+this.refCountAdj>0)this.scanBlack();else{this.color=2,H&&console.log("scan WHITE "+this.descr());let t=this.children();for(let e=0;e<t.length;e++)t[e].scan()}}scanBlack(){this.refCountAdj=0,this.color=0;let t=this.children();for(let e=0;e<t.length;e++)H&&console.log("scanBlack "+this.descr()),t[e].color!=0&&t[e].scanBlack()}collectWhite(){if(this.color==2&&!this.buffered){H&&console.log("collectWhite "+this.descr()),this.color=0,this.refCountAdj=0;let t=this.children();for(let e=0;e<t.length;e++)t[e].collectWhite();P.toBeFreedList.push(this)}}},A=P;A.NULL=new P("user",1e12,[]),A.collectingCycles=!1,A.toBeFreedList=[];var zt=class{constructor(t,e){this.f=t,this.deps=e}};function jo(n,t){return new zt(n,t)}function Ue(n){return n instanceof zt?n.deps:[]}function Ct(n){return n instanceof zt?n.f:n}var Rt=class{constructor(t,e){this.f=t,this.deps=e}};function Uo(n,t){return new Rt(n,t)}function it(n){return n instanceof Rt?n.deps:[]}function ot(n){return n instanceof Rt?n.f:n}var jt=class{constructor(t,e){this.f=t,this.deps=e}};function Po(n,t){return new jt(n,t)}function Ut(n){return n instanceof jt?n.deps:[]}function Pt(n){return n instanceof jt?n.f:n}var Mt=class{constructor(t,e){this.f=t,this.deps=e}};function Mo(n,t){return new Mt(n,t)}function Qt(n){return n instanceof Mt?n.deps:[]}function Gt(n){return n instanceof Mt?n.f:n}var Wt=class{constructor(t,e){this.f=t,this.deps=e}};function Qo(n,t){return new Wt(n,t)}function Ht(n){return n instanceof Wt?n.deps:[]}function Kt(n){return n instanceof Wt?n.f:n}var Zt=class{constructor(t,e){this.f=t,this.deps=e}};function Go(n,t){return new Zt(n,t)}function Jt(n){return n instanceof Zt?n.deps:[]}function Yt(n){return n instanceof Zt?n.f:n}function q(n){let t=[];for(let e=0;e<n.length;e++){let r=n[e];t.push(new y(r.getVertex__(),null))}return t}var G=class{constructor(t){this.f=t}get(){return this.f()}map(t){return new G(()=>t(this.f()))}lift(t,e){return new G(()=>e(this.f(),t.f()))}lift3(t,e,r){return new G(()=>r(this.f(),t.f(),e.f()))}lift4(t,e,r,i){return new G(()=>i(this.f(),t.f(),e.f(),r.f()))}};var Pe=class{constructor(){}},St=Pe;St.UNIT=new Pe;var $=class{static updates(t){return t.getStream__()}static value(t){return h.run(()=>{let e=new x;h.currentTransaction.prioritized(e.getVertex__(),()=>{e.send_(St.UNIT)});let r=e.snapshot1(t);return $.updates(t).orElse(r)})}static defer(t){return $.split(t.map(e=>[e]))}static split(t){let e=new x(null);return e.setVertex__(new A("split",0,[new y(t.getVertex__(),()=>{e.getVertex__().childrn.push(t.getVertex__());let r=[];return r.push(t.listen_(A.NULL,i=>{for(let s=0;s<i.length;s++)h.currentTransaction.post(s,()=>{h.run(()=>{e.send_(i[s])})})},!1)),r.push(()=>{let i=e.getVertex__().childrn;for(let s=i.length-1;s>=0;--s)if(i[s]==t.getVertex__()){i.splice(s,1);break}}),()=>{r.forEach(i=>i()),r.splice(0,r.length)}})])),e}};var Xt=class{constructor(t,e){this.a=t,this.b=e}};var xr=class{constructor(t){this.hasValue=!1;this.value=null;this.cell=t}},Er=class{constructor(){this.f=null;this.f_present=!1;this.a=null;this.a_present=!1}},S=class{constructor(t,e){this.value=t,e?h.run(()=>this.setStream(e)):(this.str=new at,this.vertex=new A("ConstCell",0,[]))}setStream(t){this.str=t;let e=this,r=new y(t.getVertex__(),()=>t.listen_(e.vertex,s=>{e.valueUpdate==null&&h.currentTransaction.last(()=>{e.value=e.valueUpdate,e.lazyInitValue=null,e.valueUpdate=null}),e.valueUpdate=s},!1));this.vertex=new A("Cell",0,[r]);let i=new A("Cell::setStream",1e12,[]);this.vertex.register(i),h.currentTransaction.last(()=>{this.vertex.deregister(i)})}getVertex__(){return this.vertex}getStream__(){return this.str}sample(){return h.run(()=>this.sampleNoTrans__())}sampleNoTrans__(){return this.value}sampleLazy(){let t=this;return h.run(()=>t.sampleLazyNoTrans__())}sampleLazyNoTrans__(){let t=this,e=new xr(t);return h.currentTransaction.sample(()=>{e.value=t.valueUpdate!=null?t.valueUpdate:t.sampleNoTrans__(),e.hasValue=!0,e.cell=null}),new G(()=>e.hasValue?e.value:e.cell.sample())}map(t){let e=this;return h.run(()=>$.updates(e).map(t).holdLazy(e.sampleLazy().map(Ct(t))))}lift(t,e){let r=ot(e),i=this.map(s=>l=>r(s,l));return S.apply(i,t,q(it(e)))}lift3(t,e,r){let i=Pt(r),s=p=>f=>d=>i(p,f,d),l=this.map(s);return S.apply(S.apply(l,t),e,q(Ut(r)))}lift4(t,e,r,i){let s=Gt(i),l=f=>d=>m=>g=>s(f,d,m,g),p=this.map(l);return S.apply(S.apply(S.apply(p,t),e),r,q(Qt(i)))}lift5(t,e,r,i,s){let l=Kt(s),p=d=>m=>g=>b=>_=>l(d,m,g,b,_),f=this.map(p);return S.apply(S.apply(S.apply(S.apply(f,t),e),r),i,q(Ht(s)))}lift6(t,e,r,i,s,l){let p=Yt(l),f=m=>g=>b=>_=>z=>J=>p(m,g,b,_,z,J),d=this.map(f);return S.apply(S.apply(S.apply(S.apply(S.apply(d,t),e),r),i),s,q(Jt(l)))}tracking(t){let e=new x(null),r=new A("tracking",0,[new y(this.vertex,()=>{let i=()=>{},s=p=>{let f=i,d=t(p).map(m=>m.getVertex__());for(let m=0;m<d.length;++m){let g=d[m];r.childrn.push(g),g.increment(A.NULL)}i=()=>{for(let m=0;m<d.length;++m){let g=d[m];for(let b=0;b<r.childrn.length;++b)if(r.childrn[b]===g){r.childrn.splice(b,1);break}g.decrement(A.NULL)}},f()};s(this.sample());var l=$.updates(this).listen_(r,p=>{s(p),e.send_(p)},!1);return()=>{l(),i()}})]);return e.setVertex__(r),e.holdLazy(this.sampleLazy())}static liftArray(t){return S._liftArray(t,0,t.length)}static _liftArray(t,e,r){if(r-e==0)return new S([]);if(r-e==1)return t[e].map(i=>[i]);{let i=Math.floor((e+r)/2);return S._liftArray(t,e,i).lift(S._liftArray(t,i,r),(s,l)=>()=>s.concat(l)).map(s=>s())}}static apply(t,e,r){return h.run(()=>{let i=!1,s=new Er,l=new x,p=$.updates(t),f=$.updates(e),d=()=>{i||(i=!0,h.currentTransaction.prioritized(l.getVertex__(),()=>{let b=s.f_present?s.f:t.sampleNoTrans__(),_=s.a_present?s.a:e.sampleNoTrans__();l.send_(b(_)),i=!1}))},m=new y(p.getVertex__(),()=>p.listen_(l.getVertex__(),b=>{s.f=b,s.f_present=!0,d()},!1)),g=new y(f.getVertex__(),()=>f.listen_(l.getVertex__(),b=>{s.a=b,s.a_present=!0,d()},!1));return l.setVertex__(new A("apply",0,[m,g].concat(r||[]))),l.holdLazy(new G(()=>t.sampleNoTrans__()(e.sampleNoTrans__())))})}static switchC(t){return h.run(()=>{let e=t.sampleLazy().map(m=>m.sample()),r=new x,i=null,s=!1,l=()=>{s||(s=!0,h.currentTransaction.prioritized(r.getVertex__(),()=>{r.send_(i),i=null,s=!1}))},p=null,f=$.value(t),d=new y(f.getVertex__(),()=>{let m=p===null?null:$.value(p).listen_(r.getVertex__(),b=>{i=b,l()},!1),g=f.listen_(r.getVertex__(),b=>{p=b;let _=$.value(b).listen_(r.getVertex__(),z=>{i=z,l()},!1);m!==null&&m(),m=_},!1);return()=>{g(),m()}});return r.setVertex__(new A("switchC",0,[d])),r.holdLazy(e)})}static switchS(t){return h.run(()=>{let e=new x,r=s=>{e.send_(s)},i=new y(t.getVertex__(),()=>{let s=t.sampleNoTrans__().listen_(e.getVertex__(),r,!1),l=t.getStream__().listen_(e.getVertex__(),p=>{let f=p.listen_(e.getVertex__(),r,!0);s(),s=f},!1);return()=>{l(),s()}});return e.setVertex__(new A("switchS",0,[i])),e})}calm(t){return $.updates(this).collectLazy(this.sampleLazy(),(e,r)=>{let i;return t(e,r)?i=null:i=e,new Xt(i,e)}).filterNotNull().holdLazy(this.sampleLazy())}calmRefEq(){return this.calm((t,e)=>t===e)}listen(t){return h.run(()=>$.value(this).listen(t))}static"fantasy-land/of"(t){return new S(t)}"fantasy-land/map"(t){return this.map(t)}"fantasy-land/ap"(t){return S.apply(t,this)}};var Me=class{constructor(t,e){this.h=t,this.target=e}};var xt=class extends S{constructor(t,e){super(null,null);h.run(()=>{e&&this.setStream(e),this.lazyInitValue=t})}sampleNoTrans__(){return this.value==null&&this.lazyInitValue!=null&&(this.value=this.lazyInitValue.get(),this.lazyInitValue=null),this.value}};var re=vt(Lr()),wr=class{constructor(){this.left=null;this.left_present=!1;this.right=null;this.right_present=!1}},at=class{constructor(t){this.listeners=[];this.firings=[];this.vertex=t||new A("Stream",0,[])}getVertex__(){return this.vertex}map(t){let e=new x(null),r=Ct(t);return e.vertex=new A("map",0,[new y(this.vertex,()=>this.listen_(e.vertex,i=>{e.send_(r(i))},!1))].concat(q(Ue(t)))),e}mapTo(t){let e=new x(null);return e.vertex=new A("mapTo",0,[new y(this.vertex,()=>this.listen_(e.vertex,r=>{e.send_(t)},!1))]),e}orElse(t){return this.merge(t,(e,r)=>e)}merge(t,e){let r=ot(e),i=new wr,s=!1,l=new x(null),p=()=>{s||(s=!0,h.currentTransaction.prioritized(l.getVertex__(),()=>{i.left_present&&i.right_present?l.send_(r(i.left,i.right)):i.left_present?l.send_(i.left):i.right_present&&l.send_(i.right),i.left=null,i.left_present=!1,i.right=null,i.right_present=!1,s=!1}))},f=new A("merge",0,[new y(this.vertex,()=>this.listen_(l.vertex,d=>{i.left=d,i.left_present=!0,p()},!1)),new y(t.vertex,()=>t.listen_(l.vertex,d=>{i.right=d,i.right_present=!0,p()},!1))].concat(q(it(e))));return l.vertex=f,l}filter(t){let e=new x(null),r=Ct(t);return e.vertex=new A("filter",0,[new y(this.vertex,()=>this.listen_(e.vertex,i=>{r(i)&&e.send_(i)},!1))].concat(q(Ue(t)))),e}filterNotNull(){let t=new x(null);return t.vertex=new A("filterNotNull",0,[new y(this.vertex,()=>this.listen_(t.vertex,e=>{e!==null&&t.send_(e)},!1))]),t}gate(t){return this.snapshot(t,(e,r)=>r?e:null).filterNotNull()}snapshot1(t){let e=new x(null);return e.vertex=new A("snapshot1",0,[new y(this.vertex,()=>this.listen_(e.vertex,r=>{e.send_(t.sampleNoTrans__())},!1)),new y(t.getVertex__(),null)]),e}snapshot(t,e){let r=new x(null),i=ot(e);return r.vertex=new A("snapshot",0,[new y(this.vertex,()=>this.listen_(r.vertex,s=>{r.send_(i(s,t.sampleNoTrans__()))},!1)),new y(t.getVertex__(),null)].concat(q(it(e)))),r}snapshot3(t,e,r){let i=new x(null),s=Pt(r);return i.vertex=new A("snapshot",0,[new y(this.vertex,()=>this.listen_(i.vertex,l=>{i.send_(s(l,t.sampleNoTrans__(),e.sampleNoTrans__()))},!1)),new y(t.getVertex__(),null),new y(e.getVertex__(),null)].concat(q(Ut(r)))),i}snapshot4(t,e,r,i){let s=new x(null),l=Gt(i);return s.vertex=new A("snapshot",0,[new y(this.vertex,()=>this.listen_(s.vertex,p=>{s.send_(l(p,t.sampleNoTrans__(),e.sampleNoTrans__(),r.sampleNoTrans__()))},!1)),new y(t.getVertex__(),null),new y(e.getVertex__(),null),new y(r.getVertex__(),null)].concat(q(Qt(i)))),s}snapshot5(t,e,r,i,s){let l=new x(null),p=Kt(s);return l.vertex=new A("snapshot",0,[new y(this.vertex,()=>this.listen_(l.vertex,f=>{l.send_(p(f,t.sampleNoTrans__(),e.sampleNoTrans__(),r.sampleNoTrans__(),i.sampleNoTrans__()))},!1)),new y(t.getVertex__(),null),new y(e.getVertex__(),null),new y(r.getVertex__(),null),new y(i.getVertex__(),null)].concat(q(Ht(s)))),l}snapshot6(t,e,r,i,s,l){let p=new x(null),f=Yt(l);return p.vertex=new A("snapshot",0,[new y(this.vertex,()=>this.listen_(p.vertex,d=>{p.send_(f(d,t.sampleNoTrans__(),e.sampleNoTrans__(),r.sampleNoTrans__(),i.sampleNoTrans__(),s.sampleNoTrans__()))},!1)),new y(t.getVertex__(),null),new y(e.getVertex__(),null),new y(r.getVertex__(),null),new y(i.getVertex__(),null),new y(s.getVertex__(),null)].concat(q(Jt(l)))),p}hold(t){return new S(t,this)}holdLazy(t){return new xt(t,this)}collect(t,e){return this.collectLazy(new G(()=>t),e)}collectLazy(t,e){let r=this;return h.run(()=>{let i=new ft,s=i.holdLazy(t),l=r.snapshot(s,e),p=l.map(d=>d.a),f=l.map(d=>d.b);return i.loop(f),p})}accum(t,e){return this.accumLazy(new G(()=>t),e)}accumLazy(t,e){let r=this;return h.run(()=>{let i=new ft,s=i.holdLazy(t),l=r.snapshot(s,e);return i.loop(l),l.holdLazy(t)})}once(){let t=this;return h.run(()=>t.gate(t.mapTo(!1).hold(!0)))}listen(t){return h.run(()=>this.listen_(A.NULL,t,!1))}listen_(t,e,r){this.vertex.register(t)&&h.currentTransaction.requestRegen();let i=new Me(e,t);if(this.listeners.push(i),!r&&this.firings.length!=0){let s=this.firings.slice();h.currentTransaction.prioritized(t,()=>{for(let l=0;l<s.length;l++)e(s[l])})}return()=>{let s=!1;for(let l=0;l<this.listeners.length;l++)if(this.listeners[l]==i){this.listeners.splice(l,1),s=!0;break}s&&this.vertex.deregister(t)}}"fantasy-land/map"(t){return this.map(t)}"fantasy-land/concat"(t){return this.merge(t,(e,r)=>re.Semigroup.test(e)?re.concat(e,r):e)}"fantasy-land/empty"(){return new at}},x=class extends at{constructor(t){super(t)}setVertex__(t){this.vertex=t}send_(t){this.firings.length==0&&h.currentTransaction.last(()=>{this.firings=[]}),this.firings.push(t);let e=this.listeners.slice();for(let r=0;r<e.length;r++){let i=e[r].h;h.currentTransaction.prioritized(e[r].target,()=>{h.currentTransaction.inCallback++;try{i(t),h.currentTransaction.inCallback--}catch(s){throw h.currentTransaction.inCallback--,s}})}}},ft=class extends x{constructor(){super();this.assigned__=!1;if(this.vertex.name="StreamLoop",h.currentTransaction===null)throw new Error("StreamLoop/CellLoop must be used within an explicit transaction")}loop(t){if(this.assigned__)throw new Error("StreamLoop looped more than once");this.assigned__=!0,this.vertex.addSource(new y(t.getVertex__(),()=>t.listen_(this.vertex,e=>{this.send_(e)},!1)))}};var Qe=class{constructor(t,e){this.f=ot(t),this.out=e,this.out.getVertex__().sources=this.out.getVertex__().sources.concat(q(it(t))),this.accumValid=!1}send_(t){this.accumValid?this.accum=this.f(this.accum,t):(h.currentTransaction.prioritized(this.out.getVertex__(),()=>{this.out.send_(this.accum),this.accumValid=!1,this.accum=null}),this.accum=t,this.accumValid=!0)}};var ne=class extends x{constructor(t){super();this.disableListenCheck=!1;t||(t=(e,r)=>{throw new Error("send() called more than once per transaction, which isn't allowed. Did you want to combine the events? Then pass a combining function to your StreamSink constructor.")}),this.coalescer=new Qe(t,this)}send(t){h.run(()=>{if(!this.disableListenCheck&&this.vertex.refCount()==0)throw new Error("send() was invoked before listeners were registered");if(h.currentTransaction.inCallback>0)throw new Error("You are not allowed to use send() inside a Sodium callback");this.coalescer.send_(t)})}listen_(t,e,r){let i=super.listen_(t,e,r);return this.disableListenCheck=!0,i}};var Tr=class extends xt{constructor(){super(null,new ft)}loop(t){let e=this;h.run(()=>{e.getStream__().loop(t.getStream__()),e.lazyInitValue=t.sampleLazy()})}sampleNoTrans__(){if(!this.getStream__().assigned__)throw new Error("CellLoop sampled before it was looped");return super.sampleNoTrans__()}};var ie=class extends S{constructor(t,e){super(t,new ne(e))}send(t){this.getStream__().send(t)}};var oe=vt(bt());var Dr=class{constructor(t,e,r){this._inStream=t,this._table=new oe.Dictionary(r),this._vertex=new A("Router",this._inStream.getVertex__().rank+1,[]),this._vertex.addSource(new y(this._inStream.getVertex__(),()=>this._inStream.listen_(this._vertex,i=>{let s=e(i),l=new oe.Set(r),p=[];for(let f=0;f<s.length;++f){let d=s[f];if(l.contains(d))continue;l.add(d);let m=this._table.getValue(d);if(m!=null)for(let g=0;g<m.length;++g)p.push(m[g])}for(let f=0;f<p.length;++f)p[f].send_(i)},!0)))}filterMatches(t){let e=new x,r=new A("Router::filterMatches",this._vertex.rank+1,[new y(this._vertex,()=>{this._vertex.increment(e.getVertex__());let i=this._table.getValue(t);return i==null&&(i=[],this._table.setValue(t,i)),i.push(e),()=>{this._vertex.decrement(e.getVertex__());let s=this._table.getValue(t);for(let l=s.length-1;l>=0;--l)if(s[l]==e){s.splice(l,1);break}s.length==0&&this._table.remove(t)}})]);return e.setVertex__(r),e}};var Nr=vt(bt());var ht=class{},Wo=0,Ir=class{constructor(t,e){this.t=t,this.sAlarm=e,this.seq=++Wo}},pt=class{constructor(t){this.eventQueue=new Nr.BSTree((t,e)=>t.t<e.t?-1:t.t>e.t?1:t.seq<e.seq?-1:t.seq>e.seq?1:0);h.run(()=>{this.impl=t,this.tMinimum=0;let e=new ie(t.now());this.time=e,this.time.listen(r=>{}),h.onStart(()=>{let r=this.tMinimum=Math.max(this.tMinimum,t.now());for(;;){let i=null;if(!this.eventQueue.isEmpty()){let s=this.eventQueue.minimum();s.t<=r&&(i=s)}if(i!=null)e.send(i.t),h.run(()=>i.sAlarm.send_(i.t));else break}e.send(r)})})}at(t){let e=null,r=null,i=!1,s=null,l=!1,p=new x(null),f=()=>{r!==null&&(r(),this.eventQueue.remove(e)),r=null,e=null,i&&(l||(l=!0,s=t.sampleNoTrans__()),s!==null&&(e=new Ir(s,p),this.eventQueue.add(e),r=this.impl.setTimer(s,()=>{this.tMinimum=Math.max(this.tMinimum,s),h.run(()=>{})})))};return p.setVertex__(new A("at",0,[new y(t.getVertex__(),()=>{i=!0,l=!1,h.currentTransaction.prioritized(p.getVertex__(),f);let d=t.getStream__().listen_(p.getVertex__(),m=>{s=m,l=!0,f()},!1);return()=>{i=!1,f(),d()}})])),p}};var Vr=class extends pt{constructor(){super(new kr)}},kr=class extends ht{setTimer(t,e){let r=setTimeout(e,Math.max((t-this.now())*1e3,0));return()=>{clearTimeout(r)}}now(){return Date.now()*.001}};var Fr=class extends pt{constructor(){super(new qr)}},qr=class extends ht{setTimer(t,e){let r=setTimeout(e,Math.max(t-this.now(),0));return()=>{clearTimeout(r)}}now(){return Date.now()}};var Or=class{static fromAsync(t){return e=>{let r=new x(null);return r.setVertex__(new A("map",0,[new y(e.getVertex__(),()=>e.listen_(r.getVertex__(),i=>{t(i,s=>{h.run(()=>{r.send_(s)})})},!1))])),r}}};export{S as Cell,Tr as CellLoop,ie as CellSink,Or as IOAction,Fr as MillisecondsTimerSystem,$ as Operational,Dr as Router,Vr as SecondsTimerSystem,at as Stream,ft as StreamLoop,ne as StreamSink,pt as TimerSystem,ht as TimerSystemImpl,h as Transaction,Xt as Tuple2,St as Unit,A as Vertex,zo as getTotalRegistrations,jo as lambda1,Uo as lambda2,Po as lambda3,Mo as lambda4,Qo as lambda5,Go as lambda6};
